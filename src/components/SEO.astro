---
interface Props {
  title?: string;
  description?: string;
  keywords?: string;
  image?: string;
  url?: string;
  type?: 'website' | 'article';
  article?: {
    publishedTime?: string;
    modifiedTime?: string;
    section?: string;
    tags?: string[];
  };
}

const {
  title,
  description,
  keywords,
  image,
  url,
  type = 'website',
  article
} = Astro.props;

// Site defaults
const siteTitle = 'K-12 Digital Campus Framework - Nyuchi Learning';
const defaultDescription = 'Open, shareable framework for digital transformation in K-12 education across Africa. Comprehensive blueprint for schools: infrastructure, platforms, digital literacy, AI-driven insights, and sustainable implementation.';
const defaultKeywords = 'K-12 digital transformation, African education technology, digital campus framework, educational technology Africa, school digital infrastructure, open education framework, digital literacy curriculum, education technology implementation, Zimbabwe education, Nyuchi Learning, student information system, learning management system, educational AI, mobile-first education, affordable education technology, open source education, education framework Africa, K-12 technology roadmap';
const defaultImage = '/og-image.png';
const siteUrl = 'https://learning.nyuchi.com';

const finalTitle = title ? `${title} | ${siteTitle}` : siteTitle;
const finalDescription = description || defaultDescription;
const finalKeywords = keywords || defaultKeywords;
const finalImage = image || defaultImage;
const finalUrl = url || siteUrl;
const fullImageUrl = finalImage.startsWith('http') ? finalImage : `${siteUrl}${finalImage}`;

// Organization structured data
const organizationData = {
  "@context": "https://schema.org",
  "@type": "EducationalOrganization",
  "name": "Nyuchi Learning",
  "alternateName": "Nyuchi Africa Learning Division",
  "url": siteUrl,
  "logo": {
    "@type": "ImageObject",
    "url": `${siteUrl}/nyuchi-learning-logo-main.svg`,
    "width": 200,
    "height": 60
  },
  "description": "Educational frameworks and digital transformation solutions for schools across Africa",
  "parentOrganization": {
    "@type": "Organization",
    "name": "Nyuchi Africa",
    "url": "https://nyuchi.africa"
  },
  "areaServed": {
    "@type": "Place",
    "name": "Africa"
  },
  "foundingLocation": {
    "@type": "Place",
    "name": "Zimbabwe"
  }
};

// Website structured data
const websiteData = {
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "K-12 Digital Campus Framework",
  "description": defaultDescription,
  "url": siteUrl,
  "publisher": {
    "@type": "EducationalOrganization",
    "name": "Nyuchi Learning"
  },
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": `${siteUrl}/framework?search={search_term_string}`
    },
    "query-input": "required name=search_term_string"
  }
};

// Learning resource structured data for the framework
const learningResourceData = {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "name": "K-12 Digital Campus Framework",
  "description": "Comprehensive blueprint for digital transformation in K-12 schools across Africa",
  "educationalLevel": "K-12",
  "learningResourceType": "Implementation Framework",
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": ["School Administrator", "IT Leader", "Educator", "Policymaker"]
  },
  "provider": {
    "@type": "EducationalOrganization",
    "name": "Nyuchi Learning"
  },
  "isAccessibleForFree": true,
  "educationalUse": "Digital Transformation Planning",
  "keywords": defaultKeywords,
  "inLanguage": ["en", "fr"],
  "about": [
    {
      "@type": "Thing",
      "name": "Digital Transformation"
    },
    {
      "@type": "Thing",
      "name": "Educational Technology"
    },
    {
      "@type": "Thing",
      "name": "K-12 Education"
    }
  ]
};

// Breadcrumb data (if URL suggests page hierarchy)
const breadcrumbData = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": siteUrl
    }
  ]
};
---

<!-- Primary Meta Tags -->
<title>{finalTitle}</title>
<meta name="title" content={finalTitle} />
<meta name="description" content={finalDescription} />
<meta name="keywords" content={finalKeywords} />
<link rel="canonical" href={finalUrl} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={finalUrl} />
<meta property="og:title" content={finalTitle} />
<meta property="og:description" content={finalDescription} />
<meta property="og:image" content={fullImageUrl} />
<meta property="og:site_name" content="Nyuchi Learning - K-12 Digital Campus Framework" />
<meta property="og:locale" content="en_ZW" />
<meta property="og:locale:alternate" content="en_US" />
<meta property="og:locale:alternate" content="en_GB" />
<meta property="og:locale:alternate" content="fr_FR" />

<!-- Article specific meta tags -->
{article && (
  <>
    <meta property="article:published_time" content={article.publishedTime} />
    <meta property="article:modified_time" content={article.modifiedTime} />
    <meta property="article:section" content={article.section} />
    {article.tags?.map(tag => (
      <meta property="article:tag" content={tag} />
    ))}
  </>
)}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content={finalUrl} />
<meta name="twitter:title" content={finalTitle} />
<meta name="twitter:description" content={finalDescription} />
<meta name="twitter:image" content={fullImageUrl} />
<meta name="twitter:creator" content="@nyuchilearning" />

<!-- Search Engine Tags -->
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
<meta name="googlebot" content="index, follow" />
<meta name="bingbot" content="index, follow" />
<meta name="google" content="notranslate" />

<!-- Mobile -->
<meta name="format-detection" content="telephone=no" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="apple-mobile-web-app-title" content="Nyuchi Learning" />

<!-- Geographic -->
<meta name="geo.region" content="ZW" />
<meta name="geo.placename" content="Zimbabwe" />
<meta name="language" content="English" />

<!-- Theme -->
<meta name="theme-color" content="#2C2C2C" />
<meta name="msapplication-TileColor" content="#2C2C2C" />

<!-- Structured Data - Organization -->
<script type="application/ld+json" set:html={JSON.stringify(organizationData)} />

<!-- Structured Data - Website -->
<script type="application/ld+json" set:html={JSON.stringify(websiteData)} />

<!-- Structured Data - Learning Resource -->
<script type="application/ld+json" set:html={JSON.stringify(learningResourceData)} />

<!-- Structured Data - Breadcrumb -->
<script type="application/ld+json" set:html={JSON.stringify(breadcrumbData)} />
